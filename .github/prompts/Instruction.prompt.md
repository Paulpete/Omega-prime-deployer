---
mode: agent
---
You are an expert Solana blockchain developer specializing in TypeScript and SPL Token-2022 deployments. Take the following complete code for a "Grok Copilot" script that deploys an Î©AGENT token on Solana (including all required files, utils, and scripts). Make it 10x better by enhancing robustness, security, usability, and features. Specifically:

Update all dependencies in package.json to the latest stable versions as of September 2025: @solana/web3.js to 1.98.4, @solana/spl-token to 0.4.14, @metaplex-foundation/mpl-token-metadata to 3.4.0, bs58 to 6.0.0, dotenv to 16.4.5 (or latest if higher), @types/node to 24.3.1, ts-node to 10.9.2, typescript to 5.9.2. Add any new dependencies needed for improvements (e.g., for IPFS upload, add @pinata/sdk or similar; for testing, add jest).
Incorporate best practices for deploying SPL Token-2022 on Solana: Use 'finalized' commitment where appropriate for security; add optional Token-2022 extensions like transfer fees (e.g., 1-5% configurable via .env); make metadata upload flexible (prefer off-chain via IPFS/Arweave over data URI for scalability, with fallback); ensure full idempotency and retry logic; add error handling with detailed logging; include unit tests in a new 'tests/' directory; support switching between devnet and mainnet-beta via .env (e.g., RPC_URL_DEVNET); add a post-deploy verification step using Solana Explorer API; note irreversible actions like authority nulling; recommend auditing with tools like Securinega or manual review.
Add VSCode extension recommendations to the README.md: Include "solana-developers.solana-vs-code-extension-pack" for Solana tools, "patriciobcs.solana-snippets" for snippets, "ms-vscode-remote.remote-wsl" for WSL integration, "rust-lang.rust-analyzer" for any Rust interop, "esbenp.prettier-vscode" for formatting, and "dbaeumer.vscode-eslint" for linting. Explain how these aid deployment (e.g., syntax highlighting, debugging, Anchor integration if expanded).
Use all data in the repo root: Preserve and enhance all REQUIRED_FILES, scripts, utils, and READMEs. Make the copilot more interactive (e.g., add prompts for custom metadata input like name/symbol/description/image during setMetadata).
Add a new feature to search all wallets in the repo: In the copilot menu, add an option (e.g., "9. Search all my wallets in repo") that scans the entire repo root: (1) Parse .env for variables like *_PUBKEY and list their values if valid base58; (2) Scan .cache/ for *.json files (e.g., user_auth.json, mint.json), load them as Keypairs or PublicKeys, and list public keys; (3) Recursively scan all .ts/.js/.md files for base58 strings matching Solana address pattern (^ [123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{32,44} $), excluding known program IDs like 'metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s', 'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA', 'ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL', 'TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb'; (4) Output a table of found wallets with context (file, type, address). Ensure this is secure (no private key exposure).
Overall 10x improvements: Increase supply to 10 billion if desired; add dry-run enhancements; integrate relayer with rate-limiting and API key validation; add a CLI flag for headless mode; optimize for performance (e.g., batch transactions); add documentation for expanding to Anchor framework; ensure zero-SOL cost via relayer remains; make code modular, typed, and linted.

Output only the full improved code as a single .ts file (grok-copilot.ts), with all embedded file contents updated in REQUIRED_FILES. Do not add unrelated features or violate safety rules.
Original code:
[Paste the entire provided code here, including the JSON at the start and all scripts]